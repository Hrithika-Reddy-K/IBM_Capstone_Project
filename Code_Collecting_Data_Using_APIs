#The following is the Python code for the first hands-on lab of collecting data using APIs.

#Writing a function to get the number of jobs for the Python technology.

##Import required libraries
import pandas as pd
import json
import requests

api_url = "http://127.0.0.1:5000/data"

def get_number_of_jobs_T(technology):
    response = requests.get(api_url, params={'Key Skills': technology})
    if response.status_code == 200:
        job_data = response.json()
        number_of_jobs = sum(1 for job in job_data if technology in job.get('Key Skills', ''))
        return technology, number_of_jobs
get_number_of_jobs_T('Python')

#Writing a function to find number of jobs in US for a location of choice.

import requests
api_url = "http://127.0.0.1:5000/data"

def get_number_of_jobs_L(location):
    response = requests.get(api_url, params={'Location' : location})
    if response.status_code == 200:
        job_data = response.json()
        number_of_jobs = sum(1 for job in job_data if location in job.get('Location', ''))
        return location,number_of_jobs
get_number_of_jobs_L('Detroit')

#Storing the results in an excel file
#Creating a python list of all locations for which we need to find the number of jobs postings.

Locations = ['Los Angeles', 'New York', 'San Francisco', 'Washington DC', 'Seattle', 'Austin', 'Detroit']
print(Locations[1])

#Importing libraries required to create excel spreadsheet

!pip install openpyxl
from openpyxl import Workbook

#Creating a workbook and selecting the active worksheet.
#Finding the number of jobs postings for each of the location in the above list. Writing the Location name and the number of jobs postings into the excel spreadsheet.

wb=Workbook()
ws=wb.active
ws.append(['Location','Job Postings'])
ws.append(['Los Angeles','640'])
ws.append(['New York','3226'])
ws.append(['San Francisco','435'])
ws.append(['Washington DC','5316'])
ws.append(['Seattle','3375'])
ws.append(['Austin','434'])
ws.append(['Detroit','3945'])
wb.save("job-postings.xlsx")

#Collecting the number of job postings for the following languages using the API:
C
C#
C++
Java
JavaScript
Python
Scala
Oracle
SQL Server
MySQL Server
PostgreSQL
MongoDB

import pandas as pd
import json
import requests
​
api_url = "http://127.0.0.1:5000/data"
​
def get_number_of_jobs_T(technology):
    response = requests.get(api_url, params={'Key Skills': technology})
    if response.status_code == 200:
        job_data = response.json()
        number_of_jobs = sum(1 for job in job_data if technology in job.get('Key Skills', ''))
        return technology, number_of_jobs
​
get_number_of_jobs_T('MongoDB')

from openpyxl import Workbook
wb=Workbook()
ws=wb.active
ws.append(['Technology','Job Postings'])
ws.append(['C','13498'])
ws.append(['C#','333'])
ws.append(['C++','305'])
ws.append(['Java','2609'])
ws.append(['JavaScript','355'])
ws.append(['Python','1173'])
ws.append(['Scala','33'])
ws.append(['Oracle','784'])
ws.append(['SQL Server','250'])
ws.append(['MySQL Server','0'])
ws.append(['PostgreSQL','10'])
ws.append(['MongoDB','174'])
wb.save("tech-job-postings.xlsx")
